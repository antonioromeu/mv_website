<!-- ---
import Layout from '../layouts/layout.astro';
import LandingPage from '../components/sections/landing_page.astro';
import ChuvasDeVerao from '../components/sections/cdv.astro';
import ForaDaBouca from '../components/sections/fdb.astro';
import RioTorto from '../components/sections/rt.astro';
import About from '../components/sections/about.astro';
import FestivalsAwards from '../components/sections/festivals_awards.astro';
import AssisstantDirector from '../components/sections/assistant_director.astro';
import VideoModal from '../components/video_modal.astro';
---

<Layout title="Mário Veloso">
    <LandingPage />
    <ChuvasDeVerao />
    <ForaDaBouca />
    <RioTorto />
    <About />
    <FestivalsAwards />
    <AssisstantDirector />
    <VideoModal />

    <script>
        // Use DOMContentLoaded to get the script running as soon as the HTML is ready
        document.addEventListener('DOMContentLoaded', () => {
            const sections = document.querySelectorAll('.snap-section');
            const navLinks = document.querySelectorAll('.nav-link');
            const body = document.body;

            // INTERSECTION OBSERVER: The "Modern" Mobile-First way
            // This replaces the heavy 'scroll' listener math
            const observerOptions = {
                // This creates a "detection strip" across the viewport.
                // -20% from top and -40% from bottom ensures the color 
                // changes when the section is truly the "hero" of the screen.
                rootMargin: '-45% 0px -45% 0px',
                threshold: [0, 0.1, 0.2] // Adding multiple thresholds helps Safari stay "alert"
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const el = entry.target as HTMLElement;
                        const newColor = el.getAttribute('data-color') ?? '#0000fe';
                        const sectionId = el.getAttribute('id');

                        // 1. Update Body Color
                        body.style.color = newColor;

                        // 2. Update Nav Links (Cleanly toggles the active class)
                        navLinks.forEach(link => {
                            const href = link.getAttribute('href');
                            const isActive = href && (href === `#${sectionId}` || href.endsWith(`/#${sectionId}`));
                            link.classList.toggle('nav-link-active', !!isActive);

                            // Force the link color to match if needed
                            if (isActive) {
                                (link as HTMLElement).style.color = newColor;
                            } else {
                                // IMPORTANT: If it's not active, reset it to 'inherit' 
                                // so it follows the body color automatically
                                (link as HTMLElement).style.color = 'inherit';
                            }
                        });
                    }
                });
            }, observerOptions);

            sections.forEach(section => observer.observe(section));
        });
    </script>
</BaseLayout> -->

<!DOCTYPE html>
<html>
    <head>
        <title>Mário Veloso</title>
        <meta http-equiv="refresh" content="0;url=/en/" />

        <script is:inline>
            const supportedLangs = ['en', 'pt'];
            const defaultLang = 'en';
            
            // Detect browser language (e.g., "pt-BR" -> "pt")
            const browserLang = navigator.language.split('-')[0];
            
            // Choose target language
            const targetLang = supportedLangs.includes(browserLang) ? browserLang : defaultLang;
            
            // Redirect to the subfolder
            window.location.pathname = `/${targetLang}/`;
        </script>
    </head>
    <body style="background-color: var(--color-off-white);">
    </body>
</html>